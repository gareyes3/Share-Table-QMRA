rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^2
adrate=rate*log10(2)
Time = 175
rate*Time
bval = 0.03772 #+-0.0002
T_min = -6.1
Coef= 0.1719#+-1.22 C
Tmax<-41.2
Temp<-2.4
rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^2
adrate=rate*log10(2)
Time = 175
rate*Time
bval = 0.03772 #+-0.0002
T_min = -6.1
Coef= 0.1719#+-1.22 C
Tmax<-41.2
Temp<-2.4
rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^2
adrate=rate*log10(2)
Time = 175
rate*Time
bval = 0.03772 #+-0.0002
T_min = -6.1
Coef= 0.1719#+-1.22 C
Tmax<-41.2
Temp<-2.4
rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^2
adrate=rate*log10(2)
Time = 175
rate*Time
print(adrate)
rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^2/2.303
print(adrate)
Time = 175
rate*Time
(rate*Time)/2.303
Temp<-2.7
rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^2
print(adrate)
Time = 175
(rate*Time)/2.303
#P Putida
bval = 0.03772 #+-0.0002
T_min = -6.1
Coef= 0.1719#+-1.22 C
Tmax<-41.2
Temp<-2.7
rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^2
print(adrate)
Time = 175
(rate*Time)/2.303
rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
print(adrate)
print(rate)
Time = 175
(rate*Time)
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2
print(rate)
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Time = 175
(rate*Time)
Temp<-25
#P Putida
bval = 0.03578 #+-0.0002
T_min = -1.19
Coef= 0.1719#+-1.22 C
Tmax<-41.2
Temp<-25
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Time = 175
(rate*Time)
log10(2)
10^3
log10(1000)
log(1000)
log(1000)/2.303
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2
print(rate)
Time = 175
(rate*Time)
(rate*Time)/2.303
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Time = 175
(rate*Time)/2.303
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Time = 175
(rate*Time)
Temp<-4
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Time = 175
(rate*Time)
Temp<-2.3
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Time = 175
(rate*Time)
Temp<-4.7
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Time = 175
(rate*Time)
Initial = 4.01
Final =
Fina-Initial
Temp<-4.7
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Time = 175
(rate*Time)
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Temp<-2.1
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Temp<-2.7
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Time = 175
(rate*Time)
#P Putida
bval = 0.03772 #+-0.0002
T_min = -6.1
Coef= 0.1719#+-1.22 C
Tmax<-41.2
Temp<-2.7
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Time = 175
(rate*Time)
#P Putida
bval = 0.03347 #+-0.0002
T_min = -7.7
Coef= 0.1719#+-1.22 C
Tmax<-41.2
Temp<-2.7
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Time = 175
(rate*Time)
Temp<-10
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2*log10(2)
print(rate)
Temp<-15
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2*log10(2)
print(rate)
Temp<-25
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2*log10(2)
print(rate)
Time = 175
Temp<-4
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2*log10(2)
print(rate)
Time = 175
(rate*Time)
log(10)
adrate = rate/log(10)
print(rate)
Temp<-5
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2
adrate = rate/log(10)
print(rate)
Time = 175
(rate*Time)
Temp<-5
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2
adrate = rate/log(10)
print(adrate)
Time = 175
(adrate*Time)
log(10)
log(2)
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2
print(rate)
print(adrate)
print(adrate2)
adrate2 = rate*ln(2)
print(adrate2)
adrate2 = rate*log(2)
print(adrate2)
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2
print(rate)
adrate = rate/log(10)
print(adrate)
adrate2 = rate*log(2)
print(adrate2)
log(10)
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2
print(rate)
adrate = rate/log(10)
print(adrate)
adrate2 = rate*log(2)
print(adrate2)
log(2)
adrate2 = rate*log10(2)
print(adrate2)
adrate2 = rate*log(2)
print(adrate2)
#Validation of their model, obtaining similar Histograms as theirs for spoilage
shelf_life<-c()
for (i in 1:1000){
Temp<-rnorm(1,4.4,2)
Growth_variability <- 1-(rnorm(1,0,17)/100)
Initial_pop <- rtriang(1,0,1,4)
GrowthNeedforspoilage<-7-Initial_pop
Tmin <- -1.19
bval <-0.03578
growthRate <- ((Temp-Tmin)*bval)^2
Adjusted_GrowthRate<-growthRate+Growth_variability
LogGrowthRate<-Adjusted_GrowthRate*log10(2)
Shelflifedays<-(GrowthNeedforspoilage/LogGrowthRate)
shelf_life<-c(shelf_life,Shelflifedays)
}
hist(shelf_life,breaks = 100)
abline(v=14, col = "red")
mean(shelf_life)
log10(20000)
log10(1000000)
bval = 0.03347 #+-0.0002
T_min = -7.7
Temp 4
rate = (bval*(Temp-T_min))^2
bval <- 0.03347 #+-0.0002
T_min <- -7.7
Temp<- 4
rate = (bval*(Temp-T_min))^2
lagtime = 1/((bval*(Temp-T_min))^2)
lagtime
rate
Time<-10
rate = (bval*(Temp-T_min))^2
Spoilage<-rate*Time
Spoilage
rate/24
Temp<- 10
rate = (bval*(Temp-T_min))^2
rate/24
Temp<- 25
rate = (bval*(Temp-T_min))^2
rate*Time
Time<-3
rate*Time
Temp<- 25
rate = 0.1709*(Temp+6.1)*(1-exp(0.1723*(Temp-41.2)))*(0.996-0.977)
rate
rate*Time
Time<-24
rate = 0.1709*(Temp+6.1)*(1-exp(0.1723*(Temp-41.2)))*(0.996-0.977)
rate*Time
rate = 0.1709*(Temp+6.1)*(1-exp(0.1723*(Temp-41.2)))*(0.996-0.977)
Temp = 25
Temp = 25
Time = 24
rate = 0.1709*(Temp+6.1)*(1-exp(0.1723*(Temp-41.2)))*(0.996-0.977)
rate*Time
rate = 0.1539*(Temp+7.6)*(0.996-0.947)
rate*Time
rate = 0.1539*(Temp+7.6)*0.996-0.947
rate*Time
rate = 0.1539*(Temp+7.6)*(0.996-0.947)
rate*Time
Temp<- 4
rate = (bval*(Temp-T_min))^2
rate
Temp<- 4
rate = (bval*(Temp-T_min))^2
rate
rate = (bval*(Temp-T_min))^2/2.303
rate
Temp<- 15
rate = (bval*(Temp-T_min))^2/2.303
rate
Temp<- 29
rate = (bval*(Temp-T_min))^2/2.303
rate
T_min <- -9.1
Temp<- 29
rate = (bval*(Temp-T_min))^2/2.303
rate
T_min <- -7.7
Temp<- 5
rate = (bval*(Temp-T_min))^2/2.303
rate
Temp<- 4
rate = (bval*(Temp-T_min))^2/2.303
rate
LagTime = 1/rate
LagTime
Temp<- 25
rate = (bval*(Temp-T_min))^2/2.303
rate
LagTime = 1/rate
LagTime
bval <-0.023
Tmin <--5.647
#ratemax<-(bval*(Temp-T_min))
sqrtrate<-c()
for (i in -5:35){
ratemax<-(bval*(i-T_min))
sqrtrate<-c(sqrtrate,ratemax)
}
sqrtrate<-c()
Timeseq<-seq(-5,35)
for (i in Timeseq){
ratemax<-(bval*(i-T_min))
sqrtrate<-c(sqrtrate,ratemax)
}
plot(x = Timeseq, y = sqrtrate)
sqrtrate<-c()
Timeseq<-seq(-5,35)
for (i in Timeseq){
ratemax<-(bval*(i-T_min))^2
sqrtrate<-c(sqrtrate,ratemax)
}
plot(x = Timeseq, y = sqrtrate)
#Ratworsky
bval <-0.023
Tmin <--5.647
Temp<-4
ratemax<-(bval*(Temp-T_min))
ratemax
#Ratworsky
bval <-0.023
Tmin <--5.647
Temp<-4
ratemax<-(bval*(Temp-T_min))^2
ratemax
Temp<-4
ratemax<-(bval*(Temp-T_min))
ratemax
#Ratworsky
bval <-0.023
Tmin <--5.647
Temp<-4
ratemax<-(bval*(Temp-T_min))
ratemax
sqrtrate<-c()
sqrtrate<-c()
Timeseq<-seq(-5,35)
for (i in Timeseq){
ratemax<-(bval*(i-T_min))
sqrtrate<-c(sqrtrate,ratemax)
}
plot(x = Timeseq, y = sqrtrate)
Temp<-4
ratemax<-(bval*(Temp-T_min))^2
ratemax
ratemax<-(bval*(Temp-T_min))^2/2.303
ratemax
#Ratworsky
bval <-0.023
Tmin <--5.647
Temp<-10
ratemax<-(bval*(Temp-T_min))^2/2.303
ratemax
#Ratworsky
bval <-0.023
Tmin <--5.647
Temp<-10
ratemax<-(bval*(Temp-T_min))^2/log(10)
ratemax
bval <- 0.03347 #+-0.0002
T_min <- -7.7
Temp<- 4
Time<-24
Temp<- 25
rate = (bval*(Temp-T_min))^2/2.303
rate
LagTime = 1/rate
LagTime
rate
Time<-24
Temp<- 4
rate = (bval*(Temp-T_min))^2/2.303
rate
LagTime = 1/rate
LagTime
1/0.35
1/0.035
1/1.1
runif(1,20,30)
runif(1,20,30)
library(ppcor)
library(sensitivity)
library(ggplot2)
library(randomForest)
Data <- read.csv("SensitivityOut.csv", stringsAsFactors = TRUE)
Data<-Data[-c(1)]
PCC1<-pcc(X = Data[,1:7], y=Data$TotalCFUFP, rank =TRUE, conf = 0.95, nboot = 1000)
plot(PCC1)
#8 Visuals , remaing the columns to that no error in ggplot
names(PCC1$PRCC)=c("original", "bias" ,"std.error", "minci","maxci")
#Ggplot, here is similar to a tornado plot. Also there are error bars on the 95th percentile
pairs(Data)
load("C:/Users/gareyes3/Box Sync/Share Table Project/QMRA Files/QMRA Paper/Final Analyses R Files Data/Rdata Sanitizer Analysis and Washing 2.0.RData")
box_w<-Washing_Data %>%
ggplot(aes(y = Prev,x = method, fill = method))+
stat_summary(fun.data = quantiles_95, geom="boxplot")+
geom_text(data = means_w, aes(label = Prev, y = Prev ), vjust = -0.1)+
scale_fill_grey(start = 0.4, end = .9,labels = c("1", "2", "3"),guide = "none") +
ggtitle("Illness prevalence per fruit washing distribution selected") +
theme(plot.title = element_text(size = 10))+
xlab("Fruit Washing Distribution") + ylab("Illness Prevalence")+
labs(fill = "Washing\n Method")+
scale_x_discrete(labels = c("1", "2", "3"))+
geom_hline(yintercept = 0.0149, size = 1, alpha = 0.8,linetype="dotted")
#annotate("segment", x = 1.5, xend = 1.5, y = 0.02, yend = 0.0149, colour = "black", size = 0.6 )+
#annotate("label", x=1.5, y=0.02, label= "Baseline Mean Illness Prevalence",size =3)
ggarrange(box_s,box_w ,
labels = c("A", "B"),
ncol = 2, nrow = 1)
setwd("~/GitHub/Share-Table-QMRA/R")
#Opening Libary and Inputs-------------------------------------
source("Util_Library.R")
source("Functions_Full_Analysis.R")
source("Util_FunctionFoodWaste.R")
box_w<-Washing_Data %>%
ggplot(aes(y = Prev,x = method, fill = method))+
stat_summary(fun.data = quantiles_95, geom="boxplot")+
geom_text(data = means_w, aes(label = Prev, y = Prev ), vjust = -0.1)+
scale_fill_grey(start = 0.4, end = .9,labels = c("1", "2", "3"),guide = "none") +
ggtitle("Illness prevalence per fruit washing distribution selected") +
theme(plot.title = element_text(size = 10))+
xlab("Fruit Washing Distribution") + ylab("Illness Prevalence")+
labs(fill = "Washing\n Method")+
scale_x_discrete(labels = c("1", "2", "3"))+
geom_hline(yintercept = 0.0149, size = 1, alpha = 0.8,linetype="dotted")
#annotate("segment", x = 1.5, xend = 1.5, y = 0.02, yend = 0.0149, colour = "black", size = 0.6 )+
#annotate("label", x=1.5, y=0.02, label= "Baseline Mean Illness Prevalence",size =3)
quantiles_95 <- function(x) {
r <- quantile(x, probs=c(0.05, 0.25, 0.5, 0.75, 0.95))
names(r) <- c("ymin", "lower", "middle", "upper", "ymax")
r
}
box_w<-Washing_Data %>%
ggplot(aes(y = Prev,x = method, fill = method))+
stat_summary(fun.data = quantiles_95, geom="boxplot")+
geom_text(data = means_w, aes(label = Prev, y = Prev ), vjust = -0.1)+
scale_fill_grey(start = 0.4, end = .9,labels = c("1", "2", "3"),guide = "none") +
ggtitle("Illness prevalence per fruit washing distribution selected") +
theme(plot.title = element_text(size = 10))+
xlab("Fruit Washing Distribution") + ylab("Illness Prevalence")+
labs(fill = "Washing\n Method")+
scale_x_discrete(labels = c("1", "2", "3"))+
geom_hline(yintercept = 0.0149, size = 1, alpha = 0.8,linetype="dotted")
#annotate("segment", x = 1.5, xend = 1.5, y = 0.02, yend = 0.0149, colour = "black", size = 0.6 )+
#annotate("label", x=1.5, y=0.02, label= "Baseline Mean Illness Prevalence",size =3)
ggarrange(box_s,box_w ,
labels = c("A", "B"),
ncol = 2, nrow = 1)
box_w<-Washing_Data %>%
ggplot(aes(y = Prev,x = method, fill = method))+
stat_summary(fun.data = quantiles_95, geom="boxplot")+
geom_text(data = means_w, aes(label = Prev, y = Prev ), vjust = -0.1)+
scale_fill_grey(start = 0.4, end = .9,labels = c("1", "2", "3"),guide = "none") +
ggtitle("Illness prevalence per fruit washing distribution selected") +
theme(plot.title = element_text(size = 10))+
xlab("Fruit Washing Distribution") + ylab("Illness Prevalence")+
labs(fill = "Washing\n Method")+
scale_x_discrete(labels = c("1", "2", "3"))+
geom_hline(yintercept = 0.0149, size = 1, alpha = 0.8,linetype="dotted")
box_s<-Sanitizer_Data %>%
ggplot(aes(y = Prev,x = method, fill = method))+
stat_summary(fun.data = quantiles_95, geom="boxplot")+
geom_text(data = means, aes(label = Prev, y = Prev ), size=3.5)+
scale_fill_grey(start = 0.4, end = .9,labels = c("1", "2", "3", "4", "5", "6"), guide = "none") +
ggtitle("Illness prevalence per hand-sanitizer distribution selected") +
theme(plot.title = element_text(size =10))+
xlab("Hand Sanitizer Distribution") + ylab("Illness Prevalence")+
labs(fill = "Hand\n Sanitizer")+
scale_x_discrete(labels = c("1", "2", "3", "4", "5", "6"))+
geom_hline(yintercept = 0.0149, size = 1,linetype="dotted")+
annotate("segment", x = 1.8, xend = 1.5, y = 0.014, yend = 0.0149, colour = "black", size = 0.7)+
annotate("label", x=2.0, y=0.014, label= "Baseline Mean Illness Prevalence", size =3)
ggarrange(box_s,box_w ,
labels = c("A", "B"),
ncol = 2, nrow = 1)
